{"version":3,"sources":["components/FileViewer.js","components/FileBrowser.js","dialogs/FileEditOfAccessControl.js","tabs/Files.js"],"names":["EXTENSIONS","images","code","txt","FileViewer","props","writeFile64","parts","href","split","data","state","editingValue","splice","adapter","name","join","socket","Buffer","from","toString","then","_","onClose","catch","e","window","alert","ext","Utils","getFileExtension","text","editing","formatEditFile","copyPossible","includes","readFile","undefined","file","setState","this","onError","target","onerror","src","NoImage","className","clsx","classes","img","getClassBackgroundImage","alt","mode","getEditFile","width","height","theme","themeName","value","onChange","newValue","readOnly","fontSize","setOptions","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets","editorProps","$blockScrolling","scrollPaper","dialog","paper","scroll","open","fullWidth","maxWidth","dialogTitle","id","t","color","onClick","setStateBackgroundImage","content","getContent","copyToClipboard","startIcon","disabled","variant","key","Component","withWidth","withStyles","textAlign","textarea","objectFit","justifyContent","display","BUTTON_WIDTH","TILE_HEIGHT","NOT_FOUND","USER_DATA","sortFolders","a","b","folder","getParentDir","dir","length","pop","isFile","path","toLowerCase","match","TABLE","TILE","FileBrowser","array","backgroundImage","indexOf","localStorage","setItem","backgroundImageLight","backgroundImageDark","backgroundImageColored","viewType","expanded","getItem","JSON","parse","showViewTypeButton","selected","currentDir","folders","filterEmpty","expertMode","addFolder","uploadFile","deleteItem","marked","viewer","errorText","modalEditOfAccess","queueLength","loadAllFolders","allFoldersLoaded","imagePrefix","levelPadding","mounted","suppressDeleteConfirm","browseList","browseListRunning","initialReadFinished","browseFolder","browseFolders","Promise","resolve","findItem","scrollToSelected","pathFocus","el","document","getElementById","scrollIntoView","loadFolders","foldersList","_newFolders","_resolve","Object","keys","forEach","shift","setTimeout","relPath","reject","push","processBrowseList","level","processing","readDir","files","item","folderId","_checkEmpty","all","filter","map","error","readDirSerial","_folders","isDir","size","stats","modified","modifiedAt","acl","sort","readMetaItems","objs","userData","obj","_id","title","common","meta","ts","icon","unshift","stopPropagation","pos","stringify","temp","err","lastSelect","Date","now","onSelect","cb","filterFiles","filterByType","Icon","IconOpen","IconClosed","padding","style","marginLeft","select","changeFolder","onDoubleClick","toggleFolder","lang","end","itemSelected","Hidden","xsDown","formatAcl","allowDownload","allowDelete","startsWith","IconButton","itemFolderIconBack","formatBytes","access","permissions","padStart","getFileIcon","formatSize","download","res","renderBackFolder","renderFolder","renderFile","renderItems","position","CircularProgress","zIndex","top","Toolbar","showExpertButton","edge","menuButton","menuButtonExpertActive","allowCreateFolder","allowUpload","Tooltip","parentFolder","find","findFirstFolder","applyText","cancelText","titleText","promptText","labelText","verify","parent","replace","prevProps","prevState","snapshot","setOpacityTimer","clearTimeout","items","getElementsByClassName","i","opacity","fileName","Fab","uploadCloseButton","onDragEnter","onDragLeave","onDrop","acceptedFiles","count","reader","FileReader","onabort","console","log","onload","result","readAsArrayBuffer","getRootProps","getInputProps","uploadDiv","uploadDivDragging","uploadCenterDiv","uploadCenterTextAndIcon","uploadCenterIcon","uploadCenterText","deleteRecursive","deleteFolder","parentId","f","deleteFile","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","autoFocus","info","changed","it","p","part","pathDivBreadcrumbDir","pathDivBreadcrumbSlash","pathDivBreadcrumbFile","pathDiv","pathDivBreadcrumb","Input","onKeyDown","keyCode","changeToPath","onBlur","pathDivInput","renderBreadcrumb","ready","foldersLoading","root","showToolbar","renderToolbar","renderPath","filesDiv","renderInputDialog","renderUpload","renderDeleteDialog","allowView","renderViewDialog","modalEditOfAccessControl","modalEditOfAccessObjData","renderError","LinearProgress","defaultProps","objectAddBoolean","objectEditBoolean","objectStatesView","objectImportExport","objectEditOfAccessControl","modalNewObject","_export","mixins","toolbar","minHeight","overflow","spacing","overflowX","overflowY","filesDivTable","filesDivTile","alignContent","alignItems","flexWrap","flex","itemTile","userSelect","cursor","transition","margin","background","palette","secondary","light","invertColor","main","itemNameFolderTile","fontWeight","itemNameTile","textOverflow","wordBreak","itemFolderIconTile","paddingLeft","left","type","itemSizeTile","itemImageTile","itemIconTile","primary","itemTable","lineHeight","ROW_HEIGHT","itemNameTable","verticalAlign","flexGrow","itemNameFolderTable","itemSizeTable","itemAccessTable","paddingRight","itemImageTable","marginTop","maxHeight","itemIconTable","itemFolderTable","itemFolderTemp","itemFolderIconTable","itemDownloadButtonTable","minWidth","paddingTop","itemAclButtonTable","itemDeleteButtonTable","bottom","right","border","borderRadius","marginRight","whiteSpace","paddingBottom","borderBottom","direction","readWriteArray","Owner","valueNum","Group","Everyone","newValueAccessControl","mask","ObjectRights","setValue","differentValues","applyToChildren","setMask","useEffect","_checkDifferent","newSelected","borderLeft","flexDirection","idx","bool","borderRight","Checkbox","checked","indeterminate","flatList","list","loadPath","aa","ff","DIFFERENT","FileEditOfAccessControl2","onApply","extendObject","objects","themeType","substring","lastIndexOf","object","useState","stateOwnerUser","setStateOwnerUser","stateOwnerGroup","setStateOwnerGroup","users","setUsers","groups","setGroups","setApplyToChildren","childrenCount","setChildrenCount","valueFileAccessControl","setValueFileAccessControl","differentOwner","setDifferentOwner","differentGroup","setDifferentGroup","differentObject","setDifferentObject","maskObject","setMaskObject","ids","setIds","disabledButton","setDisabledButton","progress","setProgress","I18n","getLanguage","_differentObject","_differentOwner","_differentGroup","_stateOwnerUser","_stateOwnerGroup","_valueFileAccessControl","_ids","idWithSlash","objFolder","owner","ownerGroup","keyFolder","_users","_groups","defaultAcl","defaultNewAcl","CustomModal","titleButtonApply","overflowHidden","applyDisabled","defaultAclFile","newAcl","_maskObject","label","different","val","Switch","Files","translate","word","arg1","arg2","wordCache","getObjects","TabContainer","TabContent","context","objData","FileEditOfAccessControl","promise","getObject","oldObj","setObject","chownFile","chmodFile","entries","updateItemsAcl"],"mappings":"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","file":"static/js/14.ac54e8f4.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport withWidth from '@material-ui/core/withWidth';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\n\nimport AceEditor from 'react-ace';\nimport 'ace-builds/webpack-resolver';\nimport 'ace-builds/src-noconflict/mode-json';\nimport 'ace-builds/src-noconflict/theme-clouds_midnight';\nimport 'ace-builds/src-noconflict/theme-chrome';\nimport 'ace-builds/src-noconflict/ext-language_tools'\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { IconButton } from '@material-ui/core';\n\nimport NoImage from '@iobroker/adapter-react/assets/no_icon.svg';\nimport Utils from '@iobroker/adapter-react/Components/Utils';\n\n// Icons\nimport { FaCopy as CopyIcon } from 'react-icons/fa';\nimport Brightness5Icon from '@material-ui/icons/Brightness6';\nimport CloseIcon from '@material-ui/icons/Close';\nimport SaveIcon from '@material-ui/icons/Save';\n\nconst styles = theme => ({\n    dialog: {\n        height: '100%',\n    },\n    paper: {\n        height: 'calc(100% - 64px)',\n    },\n    content: {\n        textAlign: 'center',\n    },\n    textarea: {\n        width: '100%',\n        height: '100%',\n    },\n    img: {\n        width: 'auto',\n        height: 'calc(100% - 5px)',\n        objectFit: 'contain',\n    },\n    dialogTitle: {\n        justifyContent: 'space-between',\n        display: 'flex'\n    }\n});\n\nexport const EXTENSIONS = {\n    images: ['png', 'jpg', 'svg', 'jpeg', 'jpg', 'bmp'],\n    code:   ['js', 'json', 'md'],\n    txt:    ['log', 'txt', 'html', 'css', 'xml'],\n};\n\nclass FileViewer extends Component {\n    constructor(props) {\n        super(props);\n        this.ext = Utils.getFileExtension(this.props.href);\n\n        this.state = {\n            text: null,\n            code: null,\n            editing: !!this.props.formatEditFile || false,\n            editingValue: null,\n            copyPossible: EXTENSIONS.code.includes(this.ext) || EXTENSIONS.txt.includes(this.ext)\n        };\n\n        if (this.state.copyPossible) {\n            const parts = this.props.href.split('/');\n            parts.splice(0, 2);\n            const adapter = parts[0];\n            const name = parts.splice(1).join('/');\n            this.props.socket.readFile(adapter, name)\n                .then(data => {\n                    if (data.file !== undefined) {\n                        data = data.file;\n                    }\n\n                    if (EXTENSIONS.txt.includes(this.ext)) {\n                        this.setState({ text: data, editingValue: data });\n                    } else if (EXTENSIONS.code.includes(this.ext)) {\n                        this.setState({ code: data, editingValue: data });\n                    }\n                })\n                .catch(e => window.alert('Cannot read file: ' + e));\n        }\n    }\n\n    writeFile64 = () => {\n        const parts = this.props.href.split('/');\n        const data = this.state.editingValue;\n        parts.splice(0, 2);\n        const adapter = parts[0];\n        const name = parts.splice(1).join('/');\n        this.props.socket.writeFile64(adapter, name, Buffer.from(data).toString('base64'))\n            .then(_ => this.props.onClose())\n            .catch(e => window.alert('Cannot write file: ' + e));\n    }\n\n    getEditFile(ext) {\n        switch (ext) {\n            case 'json':\n                return 'json';\n            case 'js':\n                return 'javascript';\n            case 'html':\n                return 'html';\n            case 'txt':\n                return 'html';\n            default:\n                return 'json';\n        }\n    }\n\n    getContent() {\n        if (EXTENSIONS.images.includes(this.ext)) {\n            return <img\n                onError={e => {\n                    e.target.onerror = null;\n                    e.target.src = NoImage\n                }}\n                className={clsx(this.props.classes.img, this.props.getClassBackgroundImage())}\n                src={this.props.href} alt={this.props.href} />;\n        } else if (this.state.code !== null || this.state.text !== null || this.state.editing) {\n            return <AceEditor\n                mode={this.getEditFile(this.props.formatEditFile)}\n                width=\"100%\"\n                height=\"100%\"\n                theme={this.props.themeName === 'dark' ? 'clouds_midnight' : 'chrome'}\n                value={this.state.editingValue || this.state.code || this.state.text}\n                onChange={newValue => this.setState({ editingValue: newValue })}\n                name=\"UNIQUE_ID_OF_DIV\"\n                readOnly={!this.state.editing}\n                fontSize={14}\n                setOptions={{\n                    enableBasicAutocompletion: true,\n                    enableLiveAutocompletion: true,\n                    enableSnippets: true\n                }}\n                editorProps={{ $blockScrolling: true }}\n            />\n        }\n    }\n\n    render() {\n        return <Dialog\n            classes={{ scrollPaper: this.props.classes.dialog, paper: this.props.classes.paper }}\n            scroll=\"paper\"\n            key={this.props.key}\n            open={!!this.props.href}\n            onClose={() => this.props.onClose()}\n            fullWidth={true}\n            maxWidth=\"xl\"\n            aria-labelledby=\"form-dialog-title\"\n        >\n            <div className={this.props.classes.dialogTitle}>\n                <DialogTitle id=\"form-dialog-title\">{this.props.t(this.state.editing ? 'Edit' : 'View') + ': ' + this.props.href}</DialogTitle>\n                {EXTENSIONS.images.includes(this.ext) && <div>\n                    <IconButton\n                        color={'inherit'}\n                        onClick={this.props.setStateBackgroundImage}\n                    >\n                        <Brightness5Icon />\n                    </IconButton>\n                </div>\n                }\n            </div>\n            <DialogContent className={this.props.classes.content}>\n                {this.getContent()}\n            </DialogContent>\n            <DialogActions>\n                {this.state.copyPossible ?\n                    <Button\n                        onClick={e => Utils.copyToClipboard(this.state.text || this.state.code, e)}\n                        startIcon={<CopyIcon />}\n                    >\n                        {this.props.t('Copy content')}\n                    </Button> : null}\n                {this.state.editing ?\n                    <Button\n                        disabled={this.state.editingValue === this.state.code || this.state.editingValue === this.state.text}\n                        variant=\"contained\"\n                        onClick={this.writeFile64}\n                        startIcon={<SaveIcon />}\n                    >\n                        {this.props.t('Save')}\n                    </Button> : null}\n                <Button\n                    variant=\"contained\"\n                    onClick={() => this.props.onClose()}\n                    color=\"primary\"\n                    startIcon={<CloseIcon />}\n                >\n                    {this.props.t('Close')}\n                </Button>\n            </DialogActions>\n        </Dialog>;\n    }\n}\n\nFileViewer.propTypes = {\n    key: PropTypes.string,\n    t: PropTypes.func,\n    lang: PropTypes.string,\n    expertMode: PropTypes.bool,\n    onClose: PropTypes.func,\n    href: PropTypes.string.isRequired\n};\n\nexport default withWidth()(withStyles(styles)(FileViewer));\n","/* This file is temporary here to speed-up the development of this component.\n    Later it will be moved to adapter-react\n */\n/**\n * Copyright 2020-2021, bluefox <dogafox@gmail.com>\n *\n * MIT License\n *\n **/\nimport withWidth from '@material-ui/core/withWidth';\nimport { withStyles } from '@material-ui/core/styles';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Dropzone from 'react-dropzone'\n\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Fab from '@material-ui/core/Fab';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Button from '@material-ui/core/Button';\nimport Input from '@material-ui/core/Input';\nimport { Hidden, Tooltip } from '@material-ui/core';\n\nimport ErrorDialog from '@iobroker/adapter-react/Dialogs/Error';\nimport Utils from '@iobroker/adapter-react/Components/Utils';\nimport TextInputDialog from '@iobroker/adapter-react/Dialogs/TextInput';\nimport { EXTENSIONS } from '@iobroker/adapter-react/Components/FileViewer';\nimport FileViewer from './FileViewer';\n//import FileViewer from '@iobroker/adapter-react/Components/FileViewer';\n\n// Icons\nimport RefreshIcon from '@material-ui/icons/Refresh';\nimport CloseIcon from '@material-ui/icons/Close';\nimport JsonIcon from '@material-ui/icons/Bookmark';\nimport CssIcon from '@material-ui/icons/BookmarkBorder';\nimport HtmlIcon from '@material-ui/icons/Description';\nimport EditIcon from '@material-ui/icons/Edit';\nimport JSIcon from '@material-ui/icons/Code';\nimport FileIcon from '@material-ui/icons/InsertDriveFile';\nimport UploadIcon from '@material-ui/icons/Publish';\nimport MusicIcon from '@material-ui/icons/MusicNote';\nimport DownloadIcon from '@material-ui/icons/SaveAlt';\nimport AddFolderIcon from '@material-ui/icons/CreateNewFolder';\nimport EmptyFilterIcon from '@material-ui/icons/FolderOpen';\nimport IconList from '@material-ui/icons/List';\nimport IconTile from '@material-ui/icons/ViewModule';\nimport IconBack from '@material-ui/icons/ArrowBack';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport Brightness5Icon from '@material-ui/icons/Brightness6';\n\nimport ExpertIcon from '@iobroker/adapter-react/icons/IconExpert';\nimport NoImage from '@iobroker/adapter-react/assets/no_icon.svg';\nimport IconClosed from '@iobroker/adapter-react/icons/IconClosed';\nimport IconOpen from '@iobroker/adapter-react/icons/IconOpen';\n\nconst ROW_HEIGHT   = 32;\nconst BUTTON_WIDTH = 32;\nconst TILE_HEIGHT  = 120;\nconst TILE_WIDTH   = 64;\n\nconst NOT_FOUND = 'Not found';\n\nconst styles = theme => ({\n    dialog: {\n        height: `calc(100% - ${theme.mixins.toolbar.minHeight}px)`,\n    },\n    root: {\n        width: '100%',\n        overflow: 'hidden',\n        height: '100%',\n        position: 'relative',\n    },\n    filesDiv: {\n        width: `calc(100% - ${theme.spacing(2)}px)`,\n        overflowX: 'hidden',\n        overflowY: 'auto',\n        padding: theme.spacing(1),\n    },\n    filesDivTable: {\n        height: `calc(100% - ${48 + theme.spacing(1)}px)`,\n    },\n    filesDivTile: {\n        height: `calc(100% - ${48 * 2 + theme.spacing(1)}px)`,\n        display: 'flex',\n        alignContent: 'flex-start',\n        alignItems: 'stretch',\n        flexWrap: 'wrap',\n        flex: `0 0 ${TILE_WIDTH}px`,\n    },\n\n    itemTile: {\n        position: 'relative',\n        userSelect: 'none',\n        cursor: 'pointer',\n        height: TILE_HEIGHT,\n        width: TILE_WIDTH,\n        display: 'inline-block',\n        textAlign: 'center',\n        opacity: 0.1,\n        transition: 'opacity 1s',\n        margin: 4,\n        '&:hover': {\n            background: theme.palette.secondary.light,\n            color: Utils.invertColor(theme.palette.secondary.main, true),\n        }\n    },\n    itemNameFolderTile: {\n        fontWeight: 'bold',\n    },\n    itemNameTile: {\n        width: '100%',\n        height: 32,\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        fontSize: 12,\n        textAlign: 'center',\n        wordBreak: 'break-all',\n    },\n    itemFolderIconTile: {\n        width: '100%',\n        height: TILE_HEIGHT - 32 - 16 - 8, // name + size\n        display: 'block',\n        paddingLeft: 8,\n        color: theme.palette.secondary.main || '#fbff7d',\n    },\n    itemFolderIconBack: {\n        position: 'absolute',\n        top: 22,\n        left: 18,\n        zIndex: 1,\n        color: theme.palette.type === 'dark' ? '#FFF' : '#000',\n    },\n    itemSizeTile: {\n        width: '100%',\n        height: 16,\n        textAlign: 'center',\n        fontSize: 10,\n    },\n    itemImageTile: {\n        width: 'calc(100% - 8px)',\n        height: TILE_HEIGHT - 32 - 16 - 8, // name + size\n        margin: 4,\n        display: 'block',\n        textAlign: 'center',\n        objectFit: 'contain',\n    },\n    itemIconTile: {\n        width: '100%',\n        height: TILE_HEIGHT - 32 - 16 - 8, // name + size\n        display: 'block',\n        objectFit: 'contain',\n    },\n\n    itemSelected: {\n        background: theme.palette.primary.main,\n        color: Utils.invertColor(theme.palette.primary.main, true),\n    },\n\n    itemTable: {\n        userSelect: 'none',\n        cursor: 'pointer',\n        height: ROW_HEIGHT,\n        display: 'inline-flex',\n        lineHeight: ROW_HEIGHT + 'px',\n        '&:hover': {\n            background: theme.palette.secondary.light,\n            color: Utils.invertColor(theme.palette.secondary.main, true),\n        }\n    },\n    itemNameTable: {\n        display: 'inline-block',\n        paddingLeft: 10,\n        fontSize: '1rem',\n        verticalAlign: 'top',\n        flexGrow: 1,\n    },\n    itemNameFolderTable: {\n        fontWeight: 'bold',\n    },\n    itemSizeTable: {\n        display: 'inline-block',\n        width: 60,\n        verticalAlign: 'top',\n        textAlign: 'right'\n    },\n    itemAccessTable: {\n        // display: 'inline-block',\n        verticalAlign: 'top',\n        width: 60,\n        textAlign: 'right',\n        paddingRight: 5,\n        display: 'flex',\n        justifyContent: 'center'\n    },\n    itemImageTable: {\n        display: 'inline-block',\n        width: 30,\n        marginTop: 1,\n        objectFit: 'contain',\n        maxHeight: 30,\n    },\n    itemIconTable: {\n        display: 'inline-block',\n        marginTop: 1,\n        width: 30,\n        height: 30,\n    },\n    itemFolderTable: {\n\n    },\n    itemFolderTemp: {\n        opacity: 0.4\n    },\n    itemFolderIconTable: {\n        marginTop: 1,\n        marginLeft: theme.spacing(1),\n        display: 'inline-block',\n        width: 30,\n        height: 30,\n        color: theme.palette.secondary.main || '#fbff7d',\n    },\n    itemDownloadButtonTable: {\n        display: 'inline-block',\n        width: BUTTON_WIDTH,\n        height: ROW_HEIGHT,\n        minWidth: BUTTON_WIDTH,\n        verticalAlign: 'top',\n        padding: 0,\n        '& span': {\n            paddingTop: 9\n        },\n        '& svg': {\n            width: 14,\n            height: 14,\n            fontSize: '1rem'\n        }\n    },\n    itemAclButtonTable: {\n        width: BUTTON_WIDTH,\n        height: ROW_HEIGHT,\n        minWidth:BUTTON_WIDTH,\n        verticalAlign: 'top',\n        padding: 0,\n        fontSize: 12,\n        display: 'flex'\n    },\n    itemDeleteButtonTable: {\n        display: 'inline-block',\n        width: BUTTON_WIDTH,\n        height: ROW_HEIGHT,\n        minWidth: BUTTON_WIDTH,\n        verticalAlign: 'top',\n        padding: 0,\n        '& svg': {\n            width: 18,\n            height: 18,\n            fontSize: '1.5rem'\n        }\n    },\n\n    uploadDiv: {\n        top: 0,\n        zIndex: 1,\n        bottom: 0,\n        left: 0,\n        right: 0,\n        position: 'absolute',\n        opacity: 0.9,\n        textAlign: 'center',\n        background: '#FFFFFF',\n    },\n    uploadDivDragging: {\n        opacity: 1,\n    },\n\n    uploadCenterDiv: {\n        margin: 20,\n        border: '3px dashed grey',\n        borderRadius: 30,\n        width: 'calc(100% - 40px)',\n        height: 'calc(100% - 40px)',\n        position: 'relative',\n        color: theme.palette.type === 'dark' ? '#222' : '#CCC'\n    },\n    uploadCenterIcon: {\n        width: '25%',\n        height: '25%',\n    },\n    uploadCenterText: {\n        fontSize: 24,\n        fontWeight: 'bold',\n    },\n    uploadCloseButton: {\n        zIndex: 2,\n        position: 'absolute',\n        top: 30,\n        right: 30,\n    },\n    uploadCenterTextAndIcon: {\n        position: 'absolute',\n        top: '50%',\n        left: '50%',\n        height: '30%',\n        width: '50%',\n        margin: '-15% 0 0 -25%',\n    },\n    menuButtonExpertActive: {\n        color: '#c00000',\n    },\n    pathDiv: {\n        display: 'flex',\n        width: `calc(100% - ${theme.spacing(2)}px)`,\n        marginLeft: theme.spacing(1),\n        marginRight: theme.spacing(1),\n        textOverflow: 'clip',\n        overflow: 'hidden',\n        whiteSpace: 'nowrap'\n    },\n    pathDivInput: {\n        width: '100%',\n    },\n    pathDivBreadcrumb: {\n        paddingTop: 3,\n        paddingBottom: 2,\n        borderBottom: 'solid 1px',\n    },\n    pathDivBreadcrumbDir: {\n        paddingLeft: 4,\n        paddingRight: 4,\n        paddingBottom: 4,\n        cursor: 'pointer',\n        '&:hover': {\n            background: theme.palette.type === 'dark' ? '#333' : '#CCC',\n        },\n    },\n    pathDivBreadcrumbSlash: {\n        paddingLeft: 4,\n        paddingRight: 4,\n        paddingBottom: 4,\n        opacity: 0.7,\n    },\n    pathDivBreadcrumbFile: {\n        cursor: 'pointer',\n        flexGrow: 1,\n    },\n    backgroundImageLight: {\n        background: 'white'\n    },\n    backgroundImageDark: {\n        background: 'black'\n    },\n    backgroundImageColored: {\n        background: 'silver'\n    },\n    '@media screen and (max-width: 500px)': {\n        itemNameTable: {\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            textAlign: 'end',\n            direction: 'rtl'\n        }\n    },\n});\n\nconst USER_DATA = '0_userdata.0';\n\nfunction sortFolders(a, b) {\n    if (a.folder && b.folder) {\n        return a.name > b.name ? 1 : (a.name < b.name ? -1 : 0);\n    } else if (a.folder) {\n        return -1;\n    } else if (b.folder) {\n        return 1;\n    } else {\n        return a.name > b.name ? 1 : (a.name < b.name ? -1 : 0)\n    }\n}\n\nfunction getParentDir(dir) {\n    const parts = (dir || '').split('/');\n    parts.length && parts.pop();\n    return parts.join('/');\n}\n\nfunction isFile(path) {\n    let ext = Utils.getFileExtension(path);\n    if (ext && ext.toLowerCase().match(/[a-z]+/) && ext.length < 5) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\nconst TABLE = 'Table';\nconst TILE = 'Tile';\n\n/**\n * @extends {React.Component<import('./types').FileBrowserProps>}\n */\nclass FileBrowser extends Component {\n    /**\n     * @param {Readonly<import(\"./types\").FileBrowserProps>} props\n     */\n    constructor(props) {\n        super(props);\n        let expanded = window.localStorage.getItem('files.expanded') || '[]';\n\n        try {\n            expanded = JSON.parse(expanded);\n        } catch (e) {\n            expanded = [];\n        }\n\n        let viewType;\n        if (this.props.showViewTypeButton) {\n            viewType = window.localStorage.getItem('files.viewType') || TABLE;\n        } else {\n            viewType = TABLE;\n        }\n\n        let selected = this.props.selected || window.localStorage.getItem('files.selected') || USER_DATA;\n        let currentDir = '';\n        if (isFile(selected)) {\n            currentDir = getParentDir(selected);\n        } else {\n            currentDir = selected;\n        }\n        let backgroundImage = window.localStorage.getItem('files.backgroundImage') || null;\n\n        this.state = {\n            viewType,\n            folders: {},\n            filterEmpty: window.localStorage.getItem('files.empty') !== 'false',\n            expanded,\n            currentDir,\n            expertMode: this.props.expertMode,\n            addFolder: false,\n            uploadFile: false,\n            deleteItem: '',\n            marked: [],\n            viewer: '',\n            formatEditFile: '',\n            path: selected,\n            selected,\n            errorText: '',\n            modalEditOfAccess: false,\n            backgroundImage,\n            queueLength: 0,\n            loadAllFolders: false,\n            allFoldersLoaded: false,\n        };\n\n        this.imagePrefix = this.props.imagePrefix || './files/';\n\n        this.levelPadding = this.props.levelPadding || 20;\n        this.mounted = true;\n        this.suppressDeleteConfirm = 0;\n\n        this.browseList = [];\n        this.browseListRunning = false;\n        this.initialReadFinished = false;\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.expertMode !== undefined && props.expertMode !== state.expertMode) {\n            return { expertMode: props.expertMode, loadAllFolders: !state.allFoldersLoaded && props.expertMode };\n        } else {\n            return null;\n        }\n    }\n\n    loadFolders() {\n        this.initialReadFinished = false;\n        return this.browseFolder('/')\n            .then(folders => {\n                return this.state.viewType === TABLE ?\n                    this.browseFolders([...this.state.expanded], folders)\n                    :\n                    (this.state.currentDir && this.state.currentDir !== '/' ? this.browseFolder(this.state.currentDir, folders) : Promise.resolve(folders))\n            })\n            .then(folders => this.setState({ folders }, () => {\n                if (this.state.viewType === TABLE && !this.findItem(this.state.selected)) {\n                    const parts = this.state.selected.split('/');\n                    while (parts.length && !this.findItem(parts.join('/'))) {\n                        parts.pop();\n                    }\n                    let selected;\n                    if (parts.length) {\n                        selected = parts.join('/');\n                    } else {\n                        selected = USER_DATA;\n                    }\n                    this.setState({ selected, path: selected, pathFocus: false }, () => this.scrollToSelected());\n                } else {\n                    this.scrollToSelected();\n                }\n                this.initialReadFinished = true;\n            }))\n    }\n\n    scrollToSelected() {\n        if (this.mounted) {\n            const el = document.getElementById(this.state.selected);\n            el && el.scrollIntoView();\n        }\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        this.loadFolders();\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n        this.browseList = null;\n        this.browseListRunning = false;\n    }\n\n    browseFolders(foldersList, _newFolders, _resolve) {\n        if (!_newFolders) {\n            _newFolders = {};\n            Object.keys(this.state.folders).forEach(folder => _newFolders[folder] = this.state.folders[folder]);\n        }\n\n        if (!_resolve) {\n            return new Promise(resolve => this.browseFolders(foldersList, _newFolders, resolve));\n        }\n\n        if (!foldersList || !foldersList.length) {\n            _resolve(_newFolders);\n        } else {\n            this.browseFolder(foldersList.shift(), _newFolders)\n                .then(()  => setTimeout(() => this.browseFolders(foldersList, _newFolders, _resolve), 0))\n                .catch(() => setTimeout(() => this.browseFolders(foldersList, _newFolders, _resolve), 0))\n        }\n    }\n\n    readDirSerial(adapter, relPath) {\n        return new Promise((resolve, reject) => {\n            if (this.browseList) { // if component still mounted\n                this.browseList.push({resolve, reject, adapter, relPath});\n                !this.browseListRunning && this.processBrowseList();\n            }\n        });\n    }\n\n    processBrowseList(level) {\n        if (!this.browseListRunning && this.browseList && this.browseList.length) {\n            this.browseListRunning = true;\n            if (this.browseList.length > 10) {\n                // not too often\n                if (!(this.browseList.length % 10)) {\n                    this.setState({queueLength: this.browseList.length});\n                }\n            } else {\n                this.setState({queueLength: this.browseList.length});\n            }\n\n            this.browseList[0].processing = true;\n            this.props.socket.readDir(this.browseList[0].adapter, this.browseList[0].relPath)\n                .then(files => {\n                    if (this.browseList) { // if component still mounted\n                        const item = this.browseList.shift();\n                        if (item) {\n                            const resolve = item.resolve;\n                            item.resolve = null;\n                            item.reject  = null;\n                            item.adapter = null;\n                            item.relPath = null;\n                            resolve(files);\n                            this.browseListRunning = false;\n                            if (this.browseList.length) {\n                                if (level < 5) {\n                                    this.processBrowseList(level + 1);\n                                } else {\n                                    setTimeout(() => this.processBrowseList(0), 0);\n                                }\n                            } else {\n                                this.setState({queueLength: 0});\n                            }\n                        } else {\n                            this.setState({queueLength: 0});\n                        }\n                    }\n\n                })\n                .catch(e => {\n                    if (this.browseList) { // if component still mounted\n                        const item = this.browseList.shift();\n                        if (item) {\n                            const reject = item.reject;\n                            item.resolve = null;\n                            item.reject = null;\n                            item.adapter = null;\n                            item.relPath = null;\n                            reject(e);\n                            this.browseListRunning = false;\n                            if (this.browseList.length) {\n                                if (level < 5) {\n                                    this.processBrowseList(level + 1);\n                                } else {\n                                    setTimeout(() => this.processBrowseList(0), 0);\n                                }\n                            } else {\n                                this.setState({queueLength: 0});\n                            }\n                        } else {\n                            this.setState({queueLength: 0});\n                        }\n                    }\n                });\n        }\n    }\n\n    browseFolder(folderId, _newFolders, _checkEmpty) {\n        if (!_newFolders) {\n            _newFolders = {};\n            Object.keys(this.state.folders).forEach(folder =>\n                _newFolders[folder] = this.state.folders[folder]);\n        }\n\n        if (_newFolders[folderId]) {\n            if (!_checkEmpty) {\n                return new Promise((resolve, reject) =>\n                    Promise.all(_newFolders[folderId].filter(item => item.folder).map(item =>\n                        this.browseFolder(item.id, _newFolders, true)\n                            .catch(error => { })))\n                        .then(() => resolve(_newFolders))\n                        .catch(error => reject(error)));\n            } else {\n                return Promise.resolve(_newFolders);\n            }\n        }\n\n        if (!folderId || folderId === '/') {\n            return this.props.socket.readMetaItems()\n                .then(objs => {\n                    const _folders = [];\n                    let userData = null;\n\n                    // load only adapter.admin and not other meta files like hm-rpc.0.devices.blablabla\n                    objs = objs.filter(obj => {\n                        if (!this.state.expertMode) {\n                            return obj._id === '0_userdata.0' || obj._id === 'vis.0';\n                        } else {\n                            return obj._id.split('.').length <= 2;\n                        }\n                    });\n\n                    // remember, that all folders are loaded\n                    if (this.state.expertMode) {\n                        this.setState({allFoldersLoaded: true, loadFolders: false});\n                    }\n\n                    objs.forEach(obj => {\n                        const item = {\n                            id:     obj._id,\n                            name:   obj._id,\n                            title:  (obj.common && obj.common.name) || obj._id,\n                            meta:   true,\n                            from:   obj.from,\n                            ts:     obj.ts,\n                            color:  obj.common && obj.common.color,\n                            icon:   obj.common && obj.common.icon,\n                            folder: true,\n                            acl:    obj.acl,\n                            level:  0\n                        };\n                        if (item.id === USER_DATA) {\n                            // user data must be first\n                            userData = item;\n                        } else {\n                            _folders.push(item);\n                        }\n                    });\n                    _folders.sort((a, b) => a.id > b.id ? 1 : (a.id < b.id ? -1 : 0));\n                    _folders.unshift(userData);\n\n                    _newFolders[folderId || '/'] = _folders;\n\n                    if (!_checkEmpty) {\n                        return Promise.all(_folders.filter(item => item.folder).map(item =>\n                            this.browseFolder(item.id, _newFolders, true).catch(error => { })))\n                            .then(() => _newFolders)\n                    } else {\n                        return _newFolders;\n                    }\n                })\n                .catch(e => this.initialReadFinished && window.alert('Cannot read meta items: ' + e));\n        } else {\n            const parts   = folderId.split('/');\n            const level   = parts.length;\n            const adapter = parts.shift();\n            const relPath = parts.join('/');\n\n            // make all requests here serial\n            return this.readDirSerial(adapter, relPath)\n                .then(files => {\n                    const _folders = [];\n                    files.forEach(file => {\n                        const item = {\n                            id:       folderId + '/' + file.file,\n                            ext:      Utils.getFileExtension(file.file),\n                            folder:   file.isDir,\n                            name:     file.file,\n                            size:     file.stats && file.stats.size,\n                            modified: file.modifiedAt,\n                            acl:      file.acl,\n                            level\n                        };\n                        _folders.push(item);\n                    });\n\n                    _folders.sort(sortFolders);\n                    _newFolders[folderId] = _folders;\n\n                    if (!_checkEmpty) {\n                        return Promise.all(_folders.filter(item => item.folder).map(item => this.browseFolder(item.id, _newFolders, true)))\n                            .then(() => _newFolders);\n                    } else {\n                        return _newFolders;\n                    }\n                })\n                .catch(e => {\n                    this.initialReadFinished && window.alert(`Cannot read ${adapter}${relPath ? '/' + relPath : ''}: ${e}`);\n                    _newFolders[folderId] = [];\n                    return _newFolders;\n                });\n        }\n    }\n\n    toggleFolder(item, e) {\n        e && e.stopPropagation();\n        const expanded = [...this.state.expanded];\n        const pos = expanded.indexOf(item.id);\n        if (pos === -1) {\n            expanded.push(item.id);\n            expanded.sort();\n\n            window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n\n            if (!item.temp) {\n                return this.browseFolder(item.id)\n                    .then(folders => this.setState({ expanded, folders }))\n                    .catch(err => window.alert(err === NOT_FOUND ? this.props.t('re_Cannot find \"%s\"', item.id) : this.props.t('re_Cannot read \"%s\"', item.id)));\n            } else {\n                this.setState({ expanded });\n            }\n        } else {\n            expanded.splice(pos, 1);\n            window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n            this.setState({ expanded });\n        }\n    }\n\n    changeFolder(e, folder) {\n        e && e.stopPropagation();\n\n        this.lastSelect = Date.now();\n\n        folder = folder || getParentDir(this.state.currentDir);\n\n        if (folder === '/') {\n            folder = '';\n        }\n\n        window.localStorage.setItem('files.currentDir', folder);\n\n        if (folder && !this.state.folders[folder]) {\n            return this.browseFolder(folder)\n                .then(folders =>\n                    this.setState({ folders, path: folder, currentDir: folder, selected: folder, pathFocus: false }, () => this.props.onSelect && this.props.onSelect('')));\n        } else {\n            this.setState({ currentDir: folder, selected: folder, path: folder, pathFocus: false }, () => this.props.onSelect && this.props.onSelect(''));\n        }\n    }\n\n    select(id, e, cb) {\n        if (typeof e === 'function') {\n            cb = e;\n            e = null;\n        }\n        e && e.stopPropagation();\n        this.lastSelect = Date.now();\n        window.localStorage.setItem('files.selected', id);\n        this.setState({ selected: id, path: id, pathFocus: false }, () => {\n            if (this.props.onSelect) {\n                const ext = Utils.getFileExtension(id);\n                if ((!this.props.filterFiles || this.props.filterFiles.includes(ext)) &&\n                    (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(ext))\n                ) {\n                    this.props.onSelect(id);\n                } else {\n                    this.props.onSelect('');\n                }\n            }\n            cb && cb();\n        });\n    }\n\n    renderFolder(item, expanded) {\n        if (this.state.filterEmpty && (!this.state.folders[item.id] || !this.state.folders[item.id].length) && item.id !== USER_DATA && !item.temp) {\n            return null;\n        }\n        const Icon = expanded ? IconOpen : IconClosed;\n        const padding = this.state.viewType === TABLE ? item.level * this.levelPadding : 0;\n        return <div key={item.id}\n            id={item.id}\n            style={this.state.viewType === TABLE ? { marginLeft: padding, width: 'calc(100% - ' + padding + 'px' } : {}}\n            onClick={e => this.state.viewType === TABLE ? this.select(item.id, e) : this.changeFolder(e, item.id)}\n            onDoubleClick={e => this.state.viewType === TABLE && this.toggleFolder(item, e)}\n            title={item.title && typeof item.title === 'object' ? item.title[this.props.lang] || item.title.end || '' : item.title || null}\n            className={Utils.clsx(\n                'browserItem',\n                this.props.classes['item' + this.state.viewType],\n                this.props.classes['itemFolder' + this.state.viewType],\n                this.state.selected === item.id && this.props.classes.itemSelected,\n                item.temp && this.props.classes['itemFolderTemp'],\n            )}>\n            <Icon className={this.props.classes['itemFolderIcon' + this.state.viewType]} onClick={this.state.viewType === TABLE ? e => this.toggleFolder(item, e) : undefined} />\n\n            <div className={Utils.clsx(this.props.classes['itemName' + this.state.viewType], this.props.classes['itemNameFolder' + this.state.viewType])}\n            >{item.name === USER_DATA ? this.props.t('ra_User files') : item.name}</div>\n\n            <Hidden xsDown>\n                {<div className={this.props.classes['itemSize' + this.state.viewType]}>{this.state.viewType === TABLE && this.state.folders[item.id] ? this.state.folders[item.id].length : ''}</div>}\n            </Hidden>\n\n            <Hidden xsDown>\n                {this.state.viewType === TABLE ? this.formatAcl(item.acl) : null}\n            </Hidden>\n            <Hidden xsDown>\n                {this.state.viewType === TABLE && this.props.expertMode && <div className={this.props.classes['itemDeleteButton' + this.state.viewType]} />}\n            </Hidden>\n            {this.state.viewType === TABLE && this.props.allowDownload ? <div className={this.props.classes['itemDownloadButton' + this.state.viewType]} /> : null}\n\n            {this.state.viewType === TABLE && this.props.allowDelete && this.state.folders[item.id] && this.state.folders[item.id].length && (this.state.expertMode || item.id.startsWith(USER_DATA) || item.id.startsWith('vis.0/')) ?\n                <IconButton aria-label=\"delete\"\n                    onClick={e => {\n                        e.stopPropagation();\n                        if (this.suppressDeleteConfirm > Date.now()) {\n                            this.deleteItem(item.id);\n                        } else {\n                            this.setState({ deleteItem: item.id });\n                        }\n                    }}\n                    className={this.props.classes['itemDeleteButton' + this.state.viewType]}\n                >\n                    <DeleteIcon fontSize=\"small\" />\n                </IconButton>\n                :\n                (this.state.viewType === TABLE && this.props.allowDelete ? <div className={this.props.classes['itemDeleteButton' + this.state.viewType]} /> : null)\n            }\n        </div>;\n    }\n\n    renderBackFolder() {\n        return <div key={this.state.currentDir}\n            id={this.state.currentDir}\n            onClick={e => this.changeFolder(e)}\n            title={this.props.t('re_Back to %s', getParentDir(this.state.currentDir))}\n            className={Utils.clsx(\n                'browserItem',\n                this.props.classes['item' + this.state.viewType],\n                this.props.classes['itemFolder' + this.state.viewType],\n            )}>\n            <IconClosed className={this.props.classes['itemFolderIcon' + this.state.viewType]} />\n            <IconBack className={this.props.classes.itemFolderIconBack} />\n\n            <div\n                className={Utils.clsx(this.props.classes['itemName' + this.state.viewType], this.props.classes['itemNameFolder' + this.state.viewType])}\n            >..</div>\n        </div>;\n    }\n\n    formatSize(size) {\n        return <div className={this.props.classes['itemSize' + this.state.viewType]}>{size || size === 0 ? Utils.formatBytes(size) : ''}</div>;\n    }\n\n    formatAcl(acl) {\n        let access = acl && (acl.permissions || acl.file);\n        if (access) {\n            access = access.toString(16).padStart(3, '0');\n        }\n\n        return <div className={this.props.classes['itemAccess' + this.state.viewType]}> <IconButton\n            onClick={() => this.setState({ modalEditOfAccess: true })}\n            className={this.props.classes['itemAclButton' + this.state.viewType]}>{access || '---'}</IconButton></div>;\n    }\n\n    getFileIcon(ext) {\n        switch (ext) {\n            case 'json':\n                return (<JsonIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            case 'css':\n                return (<CssIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            case 'js':\n            case 'ts':\n                return (<JSIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            case 'html':\n            case 'md':\n                return (<HtmlIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            case 'mp3':\n            case 'ogg':\n            case 'wav':\n            case 'm4a':\n            case 'mp4':\n            case 'flac':\n                return (<MusicIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            default:\n                return (<FileIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n        }\n    }\n\n    getEditFile(ext) {\n        switch (ext) {\n            case 'json':\n            case 'js':\n            case 'html':\n            case 'txt':\n                return true;\n            default:\n                return false;\n        }\n    }\n\n    setStateBackgroundImage = () => {\n        let array = ['light', 'dark', 'colored', 'delete'];\n        this.setState(({ backgroundImage }) => {\n            if (array.indexOf(backgroundImage) !== -1 && array.length - 1 !== array.indexOf(backgroundImage)) {\n                window.localStorage.setItem('files.backgroundImage', array[array.indexOf(backgroundImage) + 1]);\n                return { backgroundImage: array[array.indexOf(backgroundImage) + 1] }\n            } else {\n                window.localStorage.setItem('files.backgroundImage', array[0]);\n                return { backgroundImage: array[0] }\n            }\n        })\n    }\n\n    getClassBackgroundImage = () => {\n        //['light', 'dark', 'colored', 'delete']\n        switch (this.state.backgroundImage) {\n            case 'light':\n                return this.props.classes.backgroundImageLight;\n            case 'dark':\n                return this.props.classes.backgroundImageDark;\n            case 'colored':\n                return this.props.classes.backgroundImageColored;\n            case 'delete':\n                return null;\n            default:\n                return null;\n        }\n    }\n\n    renderFile(item) {\n        const padding = this.state.viewType === TABLE ? item.level * this.levelPadding : 0;\n        const ext = Utils.getFileExtension(item.name);\n\n        return <div\n            key={item.id}\n            id={item.id}\n            onDoubleClick={() => {\n                if (!this.props.onSelect) {\n                    this.setState({ viewer: this.imagePrefix + item.id });\n                } else if (\n                    (!this.props.filterFiles || this.props.filterFiles.includes(item.ext)) &&\n                    (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(item.ext))\n                ) {\n                    this.props.onSelect(item.id, true);\n                }\n            }}\n            onClick={e => this.select(item.id, e)}\n            style={this.state.viewType === TABLE ? { marginLeft: padding, width: 'calc(100% - ' + padding + 'px)' } : {}}\n            className={Utils.clsx(\n                'browserItem',\n                this.props.classes['item' + this.state.viewType],\n                this.props.classes['itemFile' + this.state.viewType],\n                this.state.selected === item.id && this.props.classes.itemSelected\n            )}\n        >\n            {EXTENSIONS.images.includes(ext) ?\n                <img\n                    onError={e => { e.target.onerror = null; e.target.src = NoImage }}\n                    className={Utils.clsx(this.props.classes['itemImage' + this.state.viewType], this.getClassBackgroundImage())}\n                    src={this.imagePrefix + item.id} alt={item.name}\n                />\n                :\n                this.getFileIcon(ext)}\n            <div className={this.props.classes['itemName' + this.state.viewType]}>{item.name}</div>\n            <Hidden xsDown>{this.formatSize(item.size)}</Hidden>\n            <Hidden xsDown>{this.state.viewType === TABLE ? this.formatAcl(item.acl) : null}</Hidden>\n            <Hidden xsDown>{this.state.viewType === TABLE && this.props.expertMode && this.getEditFile(ext) ?\n                <IconButton aria-label=\"delete\"\n                    onClick={(e) => {\n                        e.stopPropagation();\n                        if (!this.props.onSelect) {\n                            this.setState({ viewer: this.imagePrefix + item.id, formatEditFile: ext });\n                        } else if (\n                            (!this.props.filterFiles || this.props.filterFiles.includes(item.ext)) &&\n                            (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(item.ext))\n                        ) {\n                            this.props.onSelect(item.id, true);\n                        }\n                    }}\n                    className={this.props.classes['itemDeleteButton' + this.state.viewType]}\n                >\n                    <EditIcon fontSize=\"small\" />\n                </IconButton>\n                :\n                <div className={this.props.classes['itemDeleteButton' + this.state.viewType]} />}\n                </Hidden>\n            {this.state.viewType === TABLE && this.props.allowDownload ? <IconButton\n                download\n                href={this.imagePrefix + item.id}\n                className={this.props.classes['itemDownloadButton' + this.state.viewType]}\n                onClick={e => e.stopPropagation()}\n            ><DownloadIcon /></IconButton> : null}\n\n            {this.state.viewType === TABLE &&\n                this.props.allowDelete &&\n                item.id !== 'vis.0/' &&\n                item.id !== USER_DATA &&\n                (this.state.expertMode || item.id.startsWith(USER_DATA) || item.id.startsWith('vis.0/'))\n                ?\n                <IconButton aria-label=\"delete\"\n                    onClick={e => {\n                        e.stopPropagation();\n                        if (this.suppressDeleteConfirm > Date.now()) {\n                            this.deleteItem(item.id);\n                        } else {\n                            this.setState({ deleteItem: item.id });\n                        }\n                    }}\n                    className={this.props.classes['itemDeleteButton' + this.state.viewType]}\n                >\n                    <DeleteIcon fontSize=\"small\" />\n                </IconButton>\n                :\n                (this.state.viewType === TABLE && this.props.allowDelete ?\n                    <div className={this.props.classes['itemDeleteButton' + this.state.viewType]} />\n                    :\n                    null\n                )\n            }\n        </div>;\n    }\n\n    renderItems(folderId) {\n        if (folderId &&\n            folderId !== '/' &&\n            !this.state.expertMode &&\n            folderId !== USER_DATA && !folderId.startsWith(USER_DATA) &&\n            folderId !== 'vis.0'   && !folderId.startsWith('vis.0/')\n        ) {\n            return null;\n        }\n\n        // tile\n        if (this.state.folders && this.state.folders[folderId]) {\n            if (this.state.viewType === TILE) {\n                const res = [];\n                if (folderId && folderId !== '/') {\n                    res.push(this.renderBackFolder())\n                }\n                this.state.folders[folderId].forEach(item => {\n                    if (!this.state.expertMode &&\n                        item.id !== USER_DATA && !item.id.startsWith(USER_DATA) &&\n                        item.id !== 'vis.0'   && !item.id.startsWith('vis.0/')\n                    ) {\n                        return;\n                    }\n                    if (item.folder) {\n                        res.push(this.renderFolder(item));\n                    } else if (\n                        (!this.props.filterFiles || this.props.filterFiles.includes(item.ext)) &&\n                        (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(item.ext))\n                    ) {\n                        res.push(this.renderFile(item));\n                    }\n                });\n                return res;\n            } else {\n                return this.state.folders[folderId].map(item => {\n                    const res = [];\n                    if (item.id &&\n                        item.id !== '/' &&\n                        !this.state.expertMode &&\n                        item.id !== USER_DATA &&\n                        !item.id.startsWith(USER_DATA) &&\n                        item.id !== 'vis.0' &&\n                        !item.id.startsWith('vis.0/')) {\n                        return null;\n                    }\n\n                    if (item.folder) {\n                        const expanded = this.state.expanded.includes(item.id);\n\n                        res.push(this.renderFolder(item, expanded));\n                        if (this.state.folders[item.id] && expanded) {\n                            res.push(this.renderItems(item.id))\n                        }\n                    } else if (\n                        (!this.props.filterFiles || this.props.filterFiles.includes(item.ext)) &&\n                        (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(item.ext))\n                    ) {\n                        res.push(this.renderFile(item));\n                    } else {\n                        return null;\n                    }\n\n                    return res;\n                });\n            }\n        } else {\n            return <div style={{position: 'relative'}}>\n                <CircularProgress key={folderId} color=\"secondary\" size={24}/>\n                <div style={{position: 'absolute', zIndex: 2, top: 4, width: 24, textAlign: 'center'}} >{this.state.queueLength}</div>\n            </div>;\n        }\n    }\n\n    renderToolbar() {\n        return <Toolbar key=\"toolbar\" variant=\"dense\">\n            {this.props.showExpertButton ? <IconButton\n                edge=\"start\"\n                title={this.props.t('ra_Toggle expert mode')}\n                className={Utils.clsx(this.props.classes.menuButton, this.state.expertMode && this.props.classes.menuButtonExpertActive)}\n                aria-label=\"expert mode\"\n                onClick={() => this.setState({ expertMode: !this.state.expertMode })}\n            ><ExpertIcon /></IconButton> : null}\n            {this.props.showViewTypeButton ? <IconButton\n                edge=\"start\"\n                title={this.props.t('ra_Toggle view mode')}\n                className={this.props.classes.menuButton}\n                aria-label=\"view mode\"\n                onClick={() => {\n                    const viewType = this.state.viewType === TABLE ? TILE : TABLE;\n                    window.localStorage.setItem('files.viewType', viewType);\n                    let currentDir = this.state.selected;\n                    if (isFile(currentDir)) {\n                        currentDir = getParentDir(currentDir)\n                    }\n                    this.setState({ viewType, currentDir }, () => {\n                        if (this.state.viewType === TABLE) {\n                            this.scrollToSelected();\n                        }\n                    });\n                }}\n            >{this.state.viewType !== TABLE ? <IconList /> : <IconTile />}</IconButton> : null}\n            <IconButton\n                edge=\"start\"\n                title={this.props.t('ra_Hide empty folders')}\n                className={this.props.classes.menuButton}\n                color={this.state.filterEmpty ? 'secondary' : 'inherit'}\n                aria-label=\"filter empty\"\n                onClick={() => {\n                    window.localStorage.setItem('file.empty', !this.state.filterEmpty);\n                    this.setState({ filterEmpty: !this.state.filterEmpty });\n                }}\n            ><EmptyFilterIcon /></IconButton>\n            <IconButton\n                edge=\"start\"\n                title={this.props.t('ra_Reload files')}\n                className={this.props.classes.menuButton}\n                color={'inherit'}\n                aria-label=\"reload files\"\n                onClick={() => this.setState({ folders: {} }, () => this.loadFolders())}\n            ><RefreshIcon /></IconButton>\n            {this.props.allowCreateFolder ? <IconButton\n                edge=\"start\"\n                disabled={this.state.expertMode ? !this.state.selected : !this.state.selected.startsWith('vis.0') && !this.state.selected.startsWith(USER_DATA)}\n                title={this.props.t('ra_Create folder')}\n                className={this.props.classes.menuButton}\n                color={'inherit'}\n                aria-label=\"add folder\"\n                onClick={() => this.setState({ addFolder: true })}\n            ><AddFolderIcon /></IconButton> : null}\n            {this.props.allowUpload ? <IconButton\n                edge=\"start\"\n                disabled={this.state.expertMode ? !this.state.selected : !this.state.selected.startsWith('vis.0') && !this.state.selected.startsWith(USER_DATA)}\n                title={this.props.t('ra_Upload file')}\n                className={this.props.classes.menuButton}\n                color={'inherit'}\n                aria-label=\"upload file\"\n                onClick={() =>\n                    this.setState({uploadFile: true})}\n            ><UploadIcon /></IconButton> : null}\n            <Tooltip title={this.props.t('Background image')}>\n                <IconButton\n                    color={'inherit'}\n                    edge=\"start\"\n                    className={this.props.classes.menuButton}\n                    onClick={this.setStateBackgroundImage}\n                >\n                    <Brightness5Icon />\n                </IconButton>\n            </Tooltip>\n        </Toolbar>;\n    }\n\n    findItem(id, folders) {\n        folders = folders || this.state.folders;\n        if (!folders) {\n            return null;\n        }\n        const parts = id.split('/');\n        parts.pop();\n        const parentFolder = parts.join('/') || '/';\n        if (!folders[parentFolder]) {\n            return null;\n        }\n        return folders[parentFolder].find(item => item.id === id);\n    }\n\n    renderInputDialog() {\n        if (this.state.addFolder) {\n            let parentFolder = this.findFirstFolder(this.state.selected);\n\n            if (!parentFolder) {\n                return window.alert(this.props.t('ra_Invalid parent folder!'));\n            }\n\n            return <TextInputDialog\n                key=\"inputDialog\"\n                applyText={this.props.t('ra_Create')}\n                cancelText={this.props.t('ra_Cancel')}\n                titleText={this.props.t('ra_Create new folder in %s', this.state.selected)}\n                promptText={this.props.t('ra_If no file will be created in the folder, it will disappear after the browser closed')}\n                labelText={this.props.t('ra_Folder name')}\n                verify={text => this.state.folders[parentFolder].find(item => item.name === text) ? '' : this.props.t('ra_Duplicate name')}\n                onClose={name => {\n                    if (name) {\n                        const folders = {};\n                        Object.keys(this.state.folders).forEach(folder => folders[folder] = this.state.folders[folder]);\n                        const parent = this.findItem(parentFolder);\n                        const id = parentFolder + '/' + name;\n                        folders[parentFolder].push({\n                            id: id,\n                            level: parent.level + 1,\n                            name,\n                            folder: true,\n                            temp: true,\n                        });\n\n                        folders[parentFolder].sort(sortFolders);\n\n                        folders[id] = [];\n                        const expanded = [...this.state.expanded];\n                        if (!expanded.includes(parentFolder)) {\n                            expanded.push(parentFolder);\n                            expanded.sort();\n                        }\n                        window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n                        this.setState({ addFolder: false, folders, expanded }, () =>\n                            this.select(id));\n                    } else {\n                        this.setState({ addFolder: false });\n                    }\n                }}\n                replace={text => text.replace(/[^-_\\w\\d]/, '_')}\n            />;\n        } else {\n            return null;\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        this.setOpacityTimer && clearTimeout(this.setOpacityTimer);\n        this.setOpacityTimer = setTimeout(() => {\n            this.setOpacityTimer = null;\n            const items = window.document.getElementsByClassName('browserItem');\n            for (let i = 0; i < items.length; i++) {\n                items[i].style.opacity = 1;\n            }\n        }, 100);\n    }\n\n    uploadFile(fileName, data) {\n        const parts = fileName.split('/');\n        const adapter = parts.shift();\n        return this.props.socket.writeFile64(adapter, parts.join('/'), data)\n            .catch(e => window.alert('Cannot write file: ' + e));\n    }\n\n    findFirstFolder(id) {\n        let parentFolder = id;\n        let item = this.findItem(parentFolder);\n        // find folder\n        if (item && !item.folder) {\n            const parts = parentFolder.split('/');\n            parts.pop();\n            parentFolder = '';\n            while (parts.length) {\n                const item = this.findItem(parts.join('/'));\n                if (item && item.folder) {\n                    parentFolder = parts.join('/');\n                    break;\n                }\n            }\n        }\n\n        return parentFolder;\n    }\n\n    renderUpload() {\n        if (this.state.uploadFile) {\n            return [\n                <Fab key=\"close\" color=\"primary\" aria-label=\"close\" className={this.props.classes.uploadCloseButton}\n                    onClick={() => this.setState({ uploadFile: false })}>\n                    <CloseIcon />\n                </Fab>,\n                <Dropzone\n                    key=\"dropzone\"\n                    onDragEnter={() => this.setState({ uploadFile: 'dragging' })}\n                    onDragLeave={() => this.setState({ uploadFile: true })}\n                    onDrop={acceptedFiles => {\n                        let count = acceptedFiles.length;\n                        acceptedFiles.forEach(file => {\n                            const reader = new FileReader();\n\n                            reader.onabort = () => console.log('file reading was aborted');\n                            reader.onerror = () => console.log('file reading has failed');\n                            reader.onload  = () => {\n                                let parentFolder = this.findFirstFolder(this.state.selected);\n\n                                if (!parentFolder) {\n                                    return window.alert(this.props.t('ra_Invalid parent folder!'));\n                                }\n                                const id = parentFolder + '/' + file.name;\n                                this.uploadFile(id, reader.result)\n                                    .then(() => {\n                                        if (!--count) {\n                                            const folders = {};\n                                            Object.keys(this.state.folders).forEach(name => {\n                                                if (name !== parentFolder && !name.startsWith(parentFolder + '/')) {\n                                                    folders[name] = this.state.folders[name];\n                                                }\n                                            });\n                                            this.setState({ uploadFile: false, folders }, () =>\n                                                this.browseFolders([...this.state.expanded], folders)\n                                                    .then(folders => {\n                                                        // open current folder\n                                                        const expanded = [...this.state.expanded];\n                                                        if (!expanded.includes(parentFolder)) {\n                                                            expanded.push(parentFolder);\n                                                            expanded.sort();\n                                                            window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n                                                        }\n                                                        this.setState({ folders, expanded }, () =>\n                                                            this.select(id))\n                                                    }));\n                                        }\n                                    });\n                            };\n\n                            reader.readAsArrayBuffer(file);\n                        });\n                    }}\n                >\n                    {({ getRootProps, getInputProps }) => (\n                        <div className={Utils.clsx(this.props.classes.uploadDiv, this.state.uploadFile === 'dragging' && this.props.classes.uploadDivDragging)}\n                            {...getRootProps()}>\n                            <input {...getInputProps()} />\n                            <div className={this.props.classes.uploadCenterDiv}>\n                                <div className={this.props.classes.uploadCenterTextAndIcon}>\n                                    <UploadIcon className={this.props.classes.uploadCenterIcon} />\n                                    <div className={this.props.classes.uploadCenterText}>{\n                                        this.state.uploadFile === 'dragging' ? this.props.t('ra_Drop file here') :\n                                            this.props.t('ra_Place your files here or click here to open the browse dialog')}</div>\n                                </div>\n                            </div>\n                        </div>)}\n                </Dropzone>\n            ];\n        } else {\n            return null;\n        }\n    }\n\n    deleteRecursive(id) {\n        const item = this.findItem(id);\n        if (item.folder) {\n            return (this.state.folders[id] ? Promise.all(this.state.folders[id].map(item =>\n                    this.deleteRecursive(item.id))) : Promise.resolve())\n                .then(() => {\n                    // If it is folder of second level\n                    if (item.level >= 1) {\n                        const parts = id.split('/');\n                        const adapter = parts.shift();\n                        this.props.socket.deleteFolder(adapter, parts.join('/'))\n                            .then(() => {\n                                // remove this folder\n                                const folders = JSON.parse(JSON.stringify(this.state.folders));\n                                delete folders[item.id];\n                                // delete folder from parent item\n                                const parentId = getParentDir(item.id);\n                                const parentFolder = folders[parentId];\n                                if (parentFolder) {\n                                    const pos = parentFolder.indexOf(parentFolder.find(f => f.id === item.id));\n                                    if (pos !== -1) {\n                                        parentFolder.splice(pos, 1);\n                                    }\n\n                                    this.select(parentId, () =>\n                                        this.setState({folders}));\n                                }\n                            });\n                    }\n                });\n        } else {\n            const parts = id.split('/');\n            const adapter = parts.shift();\n            if (parts.length) {\n                return this.props.socket.deleteFile(adapter, parts.join('/'))\n                    .catch(e => window.alert('Cannot delete file: ' + e));\n            } else {\n                return Promise.resolve();\n            }\n        }\n    }\n\n    deleteItem(deleteItem) {\n        deleteItem = deleteItem || this.state.deleteItem;\n\n        this.setState({ deleteItem: '' }, () =>\n            this.deleteRecursive(deleteItem)\n                .then(() => {\n                    const pos = this.state.expanded.indexOf(deleteItem);\n                    if (pos !== -1) {\n                        const expanded = [...this.state.expanded];\n                        expanded.splice(pos, 1);\n                        window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n                        this.setState({ expanded });\n                    }\n                    /*let parentFolder = this.findFirstFolder(deleteItem);\n                    const folders = {};\n                    Object.keys(this.state.folders).forEach(name => {\n                        if (name !== parentFolder && !name.startsWith(parentFolder + '/')) {\n                            folders[name] = this.state.folders[name];\n                        }\n                    });\n                    this.setState({ folders }, () =>\n                        this.browseFolders([...this.state.expanded], folders)\n                            .then(folders => this.setState({ folders })));*/\n                })\n        );\n    }\n\n    renderDeleteDialog() {\n        if (this.state.deleteItem) {\n            return <Dialog key=\"deleteDialog\" open={true} onClose={() => this.setState({ deleteItem: '' })} aria-labelledby=\"form-dialog-title\">\n                <DialogTitle id=\"form-dialog-title\">{this.props.t('ra_Confirm deletion of %s', this.state.deleteItem.split('/').pop())}</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        {this.props.t('ra_Are you sure?')}\n                    </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                    <Button variant=\"contained\" onClick={() => {\n                        this.suppressDeleteConfirm = Date.now() + 60000 * 5;\n                        this.deleteItem();\n                    }} >{this.props.t('ra_Delete (no confirm for 5 mins)')}</Button>\n                    <Button variant=\"contained\" onClick={() => this.deleteItem()} color=\"primary\" autoFocus>{this.props.t('ra_Delete')}</Button>\n                    <Button variant=\"contained\" onClick={() => this.setState({ deleteItem: '' })} >{this.props.t('ra_Cancel')}</Button>\n                </DialogActions>\n            </Dialog>;\n        } else {\n            return false;\n        }\n    }\n\n    renderViewDialog() {\n        return this.state.viewer ? <FileViewer\n            key={this.state.viewer}\n            href={this.state.viewer}\n            formatEditFile={this.state.formatEditFile}\n            themeName={this.props.themeName}\n            setStateBackgroundImage={this.setStateBackgroundImage}\n            getClassBackgroundImage={this.getClassBackgroundImage}\n            t={this.props.t}\n            socket={this.props.socket}\n            lang={this.props.lang}\n            expertMode={this.state.expertMode}\n            onClose={() => this.setState({ viewer: '', formatEditFile: '' })}\n        /> : null;\n    }\n\n    renderError() {\n        if (this.state.errorText) {\n            return <ErrorDialog key=\"errorDialog\" text={this.state.errorText} onClose={() => this.setState({ errorText: '' })} />;\n        } else {\n            return null;\n        }\n    }\n\n    updateItemsAcl(info) {\n        const folders = JSON.parse(JSON.stringify(this.state.folders));\n        let changed;\n        info.forEach(it => {\n            const item = this.findItem(it.id, folders);\n            if (item && JSON.stringify(item.acl) !== JSON.stringify(it.acl)) {\n                item.acl = it.acl;\n                changed = true;\n            }\n        });\n        changed && this.setState({ folders });\n    }\n\n    changeToPath() {\n        setTimeout(() => {\n            if (this.state.path !== this.state.selected && (!this.lastSelect || Date.now() - this.lastSelect > 100)) {\n                let folder = this.state.path;\n                if (isFile(this.state.path)) {\n                    folder = getParentDir(this.state.path);\n                }\n                return new Promise(resolve => {\n                    if (!this.state.folders[folder]) {\n                        return this.browseFolder(folder)\n                            .then(folders => this.setState({ folders }, () => resolve(true)))\n                            .catch(err => this.setState({ errorText: err === NOT_FOUND ? this.props.t('re_Cannot find \"%s\"', folder) : this.props.t('re_Cannot read \"%s\"', folder) }));\n                    } else {\n                        return resolve(true);\n                    }\n                })\n                    .then(result =>\n                        result && this.setState({ selected: this.state.path, currentDir: folder, pathFocus: false }));\n            } else if (!this.lastSelect || Date.now() - this.lastSelect > 100) {\n                this.setState({ pathFocus: false });\n            }\n        }, 100);\n    }\n\n    renderBreadcrumb() {\n        const parts = this.state.selected.startsWith('/') ? this.state.selected.split('/') : ('/' + this.state.selected).split('/');\n        const p = [];\n        return parts.map((part, i) => {\n            part && p.push(part);\n            const path = p.join('/');\n            if (i < parts.length - 1) {\n                return [\n                    <div key={this.state.selected + '_' + i} className={this.props.classes.pathDivBreadcrumbDir} onClick={e => this.changeFolder(e, path || '/')}>\n                        {part || this.props.t('re_Root')}\n                    </div>,\n                    <span key={this.state.selected + '_s_' + i} className={this.props.classes.pathDivBreadcrumbSlash}>{'>'}</span>];\n            } else {\n                return <div key={this.state.selected + '_' + i} className={this.props.classes.pathDivBreadcrumbFile} onClick={() => this.setState({ pathFocus: true })}>{part}</div>;\n            }\n        });\n    }\n\n    renderPath() {\n        return <div key=\"path\" className={Utils.clsx(this.props.classes.pathDiv, !this.state.pathFocus && this.props.classes.pathDivBreadcrumb)}>\n            {this.state.pathFocus ?\n                <Input\n                    value={this.state.path}\n                    onKeyDown={e => e.keyCode === 13 && this.changeToPath()}\n                    onBlur={e => this.changeToPath()}\n                    onChange={e => this.setState({ path: e.target.value })}\n                    className={this.props.classes.pathDivInput}\n                />\n                :\n                this.renderBreadcrumb()\n            }\n        </div>;\n    }\n\n    render() {\n        if (!this.props.ready) {\n            return <LinearProgress key={this.props.key ? this.props.key + '_c' : 'c'} />;\n        }\n\n        if (this.state.loadAllFolders && !this.foldersLoading) {\n            this.foldersLoading = true;\n            setTimeout(() => {\n                this.setState({loadAllFolders: false, folders: {}}, () => {\n                    this.foldersLoading = false;\n                    this.loadFolders();\n                });\n            }, 300);\n        }\n\n\n        return <div key={this.props.key} style={this.props.style} className={Utils.clsx(this.props.classes.root, this.props.className)}>\n            {this.props.showToolbar ? this.renderToolbar() : null}\n            {this.state.viewType === TILE ? this.renderPath() : null}\n            <div key=\"items\" className={Utils.clsx(this.props.classes.filesDiv, this.props.classes['filesDiv' + this.state.viewType])}>\n                {this.state.viewType === TABLE ? this.renderItems('/') : this.renderItems(this.state.currentDir || '/')}\n            </div>\n            {this.props.allowUpload ? this.renderInputDialog() : null}\n            {this.props.allowUpload ? this.renderUpload() : null}\n            {this.props.allowDelete ? this.renderDeleteDialog() : null}\n            {this.props.allowView ? this.renderViewDialog() : null}\n            {this.state.modalEditOfAccess && this.props.modalEditOfAccessControl && this.props.modalEditOfAccessControl(this, this.state.modalEditOfAccessObjData)}\n            {this.renderError()}\n        </div>;\n    }\n}\n\nFileBrowser.defaultProps = {\n    objectAddBoolean: false,\n    objectEditBoolean: false,\n    objectStatesView: false,\n    objectImportExport: false,\n    objectEditOfAccessControl: false,\n    modalNewObject: () => { },\n    modalEditOfAccessControl: () => { },\n}\n\nFileBrowser.propTypes = {\n    key: PropTypes.string,\n    style: PropTypes.object,\n    className: PropTypes.string,\n    t: PropTypes.func,\n    lang: PropTypes.string,\n    socket: PropTypes.object,\n    ready: PropTypes.bool,\n    expertMode: PropTypes.bool,\n    showToolbar: PropTypes.bool,\n    allowUpload: PropTypes.bool,\n    allowDownload: PropTypes.bool,\n    allowCreateFolder: PropTypes.bool,\n    allowDelete: PropTypes.bool,\n    allowView: PropTypes.bool,\n    imagePrefix: PropTypes.string,\n    showExpertButton: PropTypes.bool,\n    viewType: PropTypes.string,\n    showViewTypeButton: PropTypes.bool,\n\n    selected: PropTypes.string,\n    tileView: PropTypes.bool,\n    filterFiles: PropTypes.array, // like ['png', 'svg', 'bmp', 'jpg', 'jpeg']\n    filterByType: PropTypes.string, // images, code or txt from FileViewer.EXTENSIONS\n    onSelect: PropTypes.func, // function (id, isDoubleClick)\n};\n\n/** @type {typeof FileBrowser} */\nconst _export = withWidth()(withStyles(styles)(FileBrowser));\nexport default _export;","import React, { useEffect, useState } from 'react';\nimport { Checkbox, LinearProgress, Switch } from '@material-ui/core';\n\nimport I18n from '@iobroker/adapter-react/i18n';\n\nimport Utils from '../Utils';\nimport CustomModal from '../components/CustomModal';\nimport SelectWithIcon from '@iobroker/adapter-react/Components/SelectWithIcon';\n\nconst readWriteArray = [\n    {\n        Owner: [\n            { name: 'read', valueNum: 0x400, title: 'read owner' },\n            { name: 'write', valueNum: 0x200, title: 'write owner' }\n        ]\n    },\n    {\n        Group: [\n            { name: 'read', valueNum: 0x40, title: 'read group' },\n            { name: 'write', valueNum: 0x20, title: 'write group' }\n        ]\n    },\n    {\n        Everyone: [\n            { name: 'read', valueNum: 0x4, title: 'read everyone' },\n            { name: 'write', valueNum: 0x2, title: 'write everyone' }\n        ]\n    },\n];\n\nconst newValueAccessControl = (value, newValue, mask) => {\n    value |= newValue & mask;\n    value &= newValue | (~mask & 0xFFFF);\n    return value;\n}\n\nconst ObjectRights = ({ value, setValue, t, differentValues, applyToChildren, mask, setMask, disabled }) => {\n    useEffect(() => {\n        if (applyToChildren) {\n            let _checkDifferent = 0;\n            for (let e = 0; e < differentValues.length; e++) {\n                _checkDifferent |= value ^ differentValues[e];\n            }\n            setMask(_checkDifferent);\n        } else {\n            setMask(0);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [differentValues, applyToChildren]);\n\n    let newSelected = value;\n\n    return <div style={{\n        display: 'flex',\n        width: 'fit-content',\n        margin: 20,\n        border: '1px solid',\n        borderLeft: 0\n    }}>\n        {readWriteArray.map(el => {\n            const name = Object.keys(el)[0];\n            return <div style={{\n                width: 150,\n                height: 150,\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                borderLeft: '1px solid'\n            }} key={name} >\n                <div style={{\n                    height: 50,\n                    display: 'flex',\n                    alignItems: 'center',\n                    fontSize: 18,\n                    borderBottom: '1px solid silver',\n                    width: '100%',\n                    justifyContent: 'center'\n                }}>{t(name)}</div>\n                <div style={{\n                    display: 'flex',\n                    width: '100%'\n                }}>\n                    {el[name].map((obj, idx) => {\n                        let bool = false;\n                        if (newSelected - obj.valueNum >= 0) {\n                            newSelected = newSelected - obj.valueNum;\n                            bool = true;\n                        }\n                        return <div style={{\n                            display: 'flex',\n                            flexDirection: 'column',\n                            flex: 1,\n                            alignItems: 'center',\n                            borderRight: idx === 0 ? '1px solid' : 0\n                        }} key={obj.valueNum}>\n                            <div style={{\n                                height: 50,\n                                borderBottom: '1px solid',\n                                width: '100%',\n                                justifyContent: 'center',\n                                display: 'flex',\n                                alignItems: 'center',\n                                color: 'silver'\n                            }}>{t(obj.name)}</div>\n                            <div style={{ height: 50, display: 'flex' }}>\n                                <Checkbox\n                                    disabled={disabled}\n                                    checked={bool}\n                                    color={mask & obj.valueNum ? 'primary' : 'secondary'}\n                                    indeterminate={!!(mask & obj.valueNum)}\n                                    style={mask & obj.valueNum ? { opacity: 0.5 } : null}\n                                    onChange={e => {\n                                        if (mask & obj.valueNum) {\n                                            mask &= (~obj.valueNum) & 0xFFFF;\n                                            setMask(mask);\n                                        }\n                                        let newValue = value;\n                                        if (!e.target.checked) {\n                                            newValue &= (~obj.valueNum) & 0xFFFF;\n                                        } else {\n                                            newValue |= obj.valueNum;\n                                        }\n                                        setValue(newValue);\n                                    }}\n                                />\n                            </div>\n                        </div>\n                    })}\n                </div>\n            </div>\n        })}\n    </div>;\n}\n\nasync function loadFolders(folderId, folders, socket) {\n    let files = folders[folderId];\n    if (!files) {\n        const parts = folderId.split('/');\n        const level = parts.length;\n        const adapter = parts.shift();\n        const relPath = parts.join('/');\n        files = await socket.readDir(adapter, relPath);\n        folders[folderId] = [];\n        for (let f = 0; f < files.length; f++) {\n            const file = files[f];\n            const item = {\n                id: folderId + '/' + file.file,\n                ext: Utils.getFileExtension(file.file),\n                folder: file.isDir,\n                name: file.file,\n                size: file.stats && file.stats.size,\n                modified: file.modifiedAt,\n                acl: file.acl,\n                level\n            };\n            folders[folderId].push(item);\n        }\n    }\n\n    for (let f = 0; f < files.length; f++) {\n        const item = files[f];\n        if (item.folder) {\n            await loadFolders(item.id, folders, socket);\n        }\n    }\n}\n\nfunction flatList(folders) {\n    const list = {};\n\n    Object.keys(folders)\n        .forEach(key => {\n            list[key] = {\n                folder: true\n            };\n            folders[key].forEach(item => {\n                list[item.id] = item;\n            });\n        });\n\n    return list;\n}\n\nasync function loadPath(socket, folders, path, adapter, part, level) {\n    if (typeof path === 'string') {\n        path = path.split('/');\n        level = 0;\n        adapter = path.shift();\n        part = '';\n    }\n\n    if (path.length >= level) {\n        return;\n    }\n\n    if (folders[adapter + part]) {\n        if (path.length - 1 === level) {\n            // try to find file\n            const aa = adapter + part + '/' + path[level];\n            const ff = folders[adapter + part].find(item => item.id === aa);\n            if (ff && ff.folder) {\n                // load all\n                await loadFolders(adapter + part, folders, socket);\n            }\n            return;\n        }\n        part += '/' + path[level];\n\n        await loadPath(socket, folders, path, adapter, part, level + 1);\n    } else {\n        // load path\n        const files = await socket.readDir(adapter, part);\n        folders[adapter + part] = [];\n        files.forEach(file => {\n            const item = {\n                id:       part + '/' + file.file,\n                ext:      Utils.getFileExtension(file.file),\n                folder:   file.isDir,\n                name:     file.file,\n                size:     file.stats && file.stats.size,\n                modified: file.modifiedAt,\n                acl:      file.acl,\n                level\n            };\n\n            folders[adapter + part].push(item);\n        });\n\n        await loadPath(socket, folders, path, adapter, part, level + 1);\n    }\n}\n\nconst DIFFERENT = 'different';\n\nconst FileEditOfAccessControl2 = ({ onClose, onApply, open, selected, extendObject, objects, t, themeType, folders, socket }) => {\n    const select = selected.substring(0, selected.lastIndexOf('/')) || selected;\n    const object = selected.split('/').length === 1 ? folders['/'].find(({ id }) => id === selected) : folders[select].find(({ id }) => id === selected);\n    const [stateOwnerUser, setStateOwnerUser] = useState(null);\n    const [stateOwnerGroup, setStateOwnerGroup] = useState(null);\n    const [users, setUsers] = useState([]);\n    const [groups, setGroups] = useState([]);\n    const [applyToChildren, setApplyToChildren] = useState(false);\n    const [childrenCount, setChildrenCount] = useState(0);\n    const [valueFileAccessControl, setValueFileAccessControl] = useState(null);\n    const [differentOwner, setDifferentOwner] = useState(false);\n    const [differentGroup, setDifferentGroup] = useState(false);\n    const [differentObject, setDifferentObject] = useState([]);\n    const [maskObject, setMaskObject] = useState(0);\n    const [ids, setIds] = useState([]);\n    const [disabledButton, setDisabledButton] = useState(true);\n    const [progress, setProgress] = useState(false);\n\n    const lang = I18n.getLanguage();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    useEffect(async () => {\n        let _differentObject = [];\n\n        let id = object.id;\n\n        let _differentOwner = false;\n        let _differentGroup = false;\n        let _stateOwnerUser = null;\n        let _stateOwnerGroup = null;\n        let _valueFileAccessControl = null;\n        const _ids = [];\n        let count = 0\n\n        await loadPath(socket, folders, id);\n\n        const list = flatList(folders);\n\n        let idWithSlash = id + '/';\n\n        Object.keys(list).forEach(key => {\n            if (key === '/') {\n                return;\n            }\n\n            if (key === id || key.startsWith(idWithSlash)) {\n                if (!key.includes('/') && objects[key]) { // it is object\n                    const objFolder = objects[key];\n                    count++;\n                    _ids.push(objFolder);\n\n                    if (_valueFileAccessControl === null && objFolder.acl.file !== undefined) {\n                        _valueFileAccessControl = objFolder.acl.file;\n                    }\n                    if (_stateOwnerUser === null && objFolder.acl.owner !== undefined) {\n                        _stateOwnerUser = objFolder.acl.owner;\n                    }\n                    if (_stateOwnerGroup === null && objFolder.acl.ownerGroup !== undefined) {\n                        _stateOwnerGroup = objFolder.acl.ownerGroup;\n                    }\n\n                    if (!differentOwner && _stateOwnerUser !== objFolder.acl.owner && objFolder.acl.owner !== undefined) {\n                        _differentOwner = true;\n                    }\n                    if (!differentGroup && _stateOwnerGroup !== objFolder.acl.ownerGroup && objFolder.acl.ownerGroup !== undefined) {\n                        _differentGroup = true;\n                    }\n                    if (objFolder.acl.file !== undefined && _valueFileAccessControl !== objFolder.acl.file && !_differentObject.includes(objFolder.acl.file)) {\n                        _differentObject.push(objFolder.acl.file);\n                    }\n                } else if (!list[key].folder) {\n                    count++;\n                    const keyFolder = list[key];\n                    _ids.push(keyFolder);\n                    if (_valueFileAccessControl === null && keyFolder.acl.permissions !== undefined) {\n                        _valueFileAccessControl = keyFolder.acl.permissions;\n                    }\n                    if (_stateOwnerUser === null && keyFolder.acl.owner !== undefined) {\n                        _stateOwnerUser = keyFolder.acl.owner;\n                    }\n                    if (_stateOwnerGroup === null && keyFolder.acl.ownerGroup !== undefined) {\n                        _stateOwnerGroup = keyFolder.acl.ownerGroup;\n                    }\n\n                    if (!differentOwner && _stateOwnerUser !== keyFolder.acl.owner && keyFolder.acl.owner !== undefined) {\n                        _differentOwner = true;\n                    }\n                    if (!differentGroup && _stateOwnerGroup !== keyFolder.acl.ownerGroup && keyFolder.acl.ownerGroup !== undefined) {\n                        _differentGroup = true;\n                    }\n                    if (keyFolder.acl.permissions !== undefined && _valueFileAccessControl !== keyFolder.acl.permissions && !_differentObject.includes(keyFolder.acl.permissions)) {\n                        _differentObject.push(keyFolder.acl.permissions);\n                    }\n                }\n            }\n        });\n\n        const _users = [];\n        const _groups = [];\n        // Get users and groups\n        Object.keys(objects).forEach(_id => {\n            const obj = objects[_id];\n            if (_id.startsWith('system.group.') && obj?.type === 'group') {\n                _groups.push(obj);\n            } else\n            if (_id.startsWith('system.user.') && obj?.type === 'user') {\n                _users.push(obj);\n            }\n        });\n\n        const defaultAcl = objects['system.config'].common.defaultNewAcl;\n\n        _stateOwnerUser = _stateOwnerUser || defaultAcl.owner;\n        _stateOwnerGroup = _stateOwnerGroup || defaultAcl.ownerGroup;\n        _valueFileAccessControl = _valueFileAccessControl || defaultAcl.file;\n        setValueFileAccessControl(_valueFileAccessControl);\n\n        setStateOwnerUser(_stateOwnerUser);\n        setStateOwnerGroup(_stateOwnerGroup);\n\n        setDifferentOwner(_differentOwner);\n        setDifferentGroup(_differentGroup);\n\n        setUsers(_users);\n        setGroups(_groups);\n\n        object.folder && setApplyToChildren(true);\n        setChildrenCount(count);\n\n        setDifferentObject(_differentObject);\n\n        setIds(_ids);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [objects, selected]);\n\n    useEffect(() => {\n        if (applyToChildren) {\n            if (differentOwner) {\n                stateOwnerUser !== DIFFERENT && setStateOwnerUser(DIFFERENT);\n            }\n\n            if (differentGroup) {\n                stateOwnerGroup !== DIFFERENT && setStateOwnerGroup(DIFFERENT);\n            }\n        } else {\n            if (stateOwnerUser && stateOwnerUser === DIFFERENT) {\n                setStateOwnerUser(objects[selected].acl.owner);\n            }\n            if (stateOwnerGroup && stateOwnerGroup === DIFFERENT) {\n                setStateOwnerGroup(objects[selected].acl.ownerGroup);\n            }\n        }\n        console.log('stateOwnerUser ' +stateOwnerUser)\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [applyToChildren, stateOwnerUser, stateOwnerGroup, differentOwner, differentGroup]);\n\n    if (!ids.length) {\n        return <LinearProgress />;\n    } else {\n        return <CustomModal\n            open={open}\n            titleButtonApply=\"apply\"\n            overflowHidden\n            applyDisabled={disabledButton}\n            progress={progress}\n            onClose={onClose}\n            onApply={() => {\n                setProgress(true);\n                setTimeout(async () => {\n                    const defaultAclFile = objects['system.config'].common?.defaultNewAcl?.file || 0x664;\n\n                    if (!applyToChildren) {\n                        const parts = object.id.split('/');\n                        const adapter = parts.shift();\n                        const path = parts.join('/');\n                        let newAcl = {};\n                        let changed = false;\n                        if (!object.folder) {\n                            if (object.acl?.permissions !== valueFileAccessControl) {\n                                newAcl.permissions = valueFileAccessControl;\n                                changed = true;\n                            }\n                            if (object.acl?.owner !== stateOwnerUser) {\n                                newAcl.owner = stateOwnerUser;\n                                changed = true;\n                            }\n                            if (object.acl?.ownerGroup !== stateOwnerGroup) {\n                                newAcl.ownerGroup = stateOwnerGroup;\n                                changed = true;\n                            }\n                            changed && (await extendObject(adapter, path, newAcl));\n                        } else if (!parts.length && objects[object.id]) {\n                            // setObject(acl)\n                            const obj = objects[object.id];\n                            if (obj.acl?.file !== valueFileAccessControl) {\n                                obj.acl = obj.acl || {};\n                                obj.acl.file = valueFileAccessControl;\n                                changed = true;\n                            }\n                            if (obj.acl?.owner !== stateOwnerUser) {\n                                obj.acl = obj.acl || {};\n                                obj.acl.owner = stateOwnerUser;\n                                changed = true;\n                            }\n                            if (obj.acl?.ownerGroup !== stateOwnerGroup) {\n                                obj.acl = obj.acl || {};\n                                obj.acl.ownerGroup = stateOwnerGroup;\n                                changed = true;\n                            }\n                            changed && (await extendObject(obj._id, obj));\n                        }\n                    }\n                    else {\n                        let _maskObject = ~maskObject & 0xFFFF;\n                        for (let i = 0; i < ids.length; i++) {\n                            const item = ids[i];\n                            let changed = false;\n\n                            if (item._id) {\n                                // it is object\n                                const permissions = newValueAccessControl(item.acl?.file || defaultAclFile, valueFileAccessControl, _maskObject);\n                                if (permissions !== item.acl?.file) {\n                                    item.acl = item.acl || {};\n                                    item.acl.file = permissions;\n                                    changed = true;\n                                }\n                                if (stateOwnerUser !== DIFFERENT && stateOwnerUser !== item.acl?.owner) {\n                                    item.acl = item.acl || {};\n                                    item.acl.owner = stateOwnerUser;\n                                    changed = true;\n                                }\n                                if (stateOwnerGroup !== DIFFERENT && stateOwnerGroup !== item.acl?.ownerGroup) {\n                                    item.acl = item.acl || {};\n                                    item.acl.ownerGroup = stateOwnerGroup;\n                                    changed = true;\n                                }\n                                changed && (await extendObject(item._id, item));\n                            } else {\n                                if (item && !item.folder) {\n                                    const newAcl = {};\n                                    const permissions = newValueAccessControl(item.acl?.permissions || defaultAclFile, valueFileAccessControl, _maskObject);\n                                    if (permissions !== item.acl?.permissions) {\n                                        newAcl.permissions = permissions;\n                                        changed = true;\n                                    }\n                                    if (stateOwnerUser !== DIFFERENT && stateOwnerUser !== item.acl?.owner) {\n                                        newAcl.owner = stateOwnerUser;\n                                        changed = true;\n                                    }\n                                    if (stateOwnerGroup.value !== DIFFERENT && stateOwnerGroup !== item.acl?.ownerGroup) {\n                                        newAcl.ownerGroup = stateOwnerGroup;\n                                        changed = true;\n                                    }\n                                    if (changed) {\n                                        const parts = item.id.split('/');\n                                        const adapter = parts.shift();\n                                        const path = parts.join('/');\n                                        changed && (await extendObject(adapter, path, newAcl));\n                                    }\n                                }\n                            }\n                        }\n                    }\n\n                    setProgress(false);\n                    onApply();\n                }, 200);\n            }}\n        >\n            <div style={{ display: 'flex', flexDirection: 'column' }}>\n                <div style={{\n                    margin: 10,\n                    fontSize: 20\n                }}>{t('Access control list: %s', selected)}</div>\n\n                <div style={{ display: 'flex' }}>\n                    <SelectWithIcon\n                        fullWidth\n                        style={{ marginRight: 10 }}\n                        label={t('Owner user')}\n                        lang={lang}\n                        list={users}\n                        t={t}\n                        disabled={progress}\n                        value={stateOwnerUser}\n                        themeType={themeType}\n                        different={differentOwner ? DIFFERENT : false}\n                        onChange={val => {\n                            setDifferentOwner(false);\n                            setStateOwnerUser(val);\n                            setDisabledButton(false);\n                        }}\n                    />\n                    <SelectWithIcon\n                        fullWidth\n                        label={t('Owner group')}\n                        lang={lang}\n                        list={groups}\n                        t={t}\n                        disabled={progress}\n                        value={stateOwnerGroup}\n                        themeType={themeType}\n                        different={differentGroup ? DIFFERENT : false}\n                        onChange={val => {\n                            setDifferentGroup(false);\n                            setStateOwnerGroup(val);\n                            setDisabledButton(false);\n                        }}\n                    />\n                </div>\n\n                <div style={{\n                    display: 'flex',\n                    margin: 10,\n                    alignItems: 'center',\n                    fontSize: 10,\n                    marginLeft: 0,\n                    color: 'silver'\n                }}>\n                    <div style={(!object.folder || !applyToChildren) ? { color: 'green' } : null}>{t('to apply one item')}</div>\n                    <Switch\n                        disabled={ids.length === 1 || progress}\n                        checked={(!objects[object.id] && !!object.folder) || applyToChildren}\n                        onChange={e => {\n                            setApplyToChildren(e.target.checked);\n                            setDisabledButton(false);\n                        }}\n                        color=\"primary\"\n                    />\n                    <div style={(object.folder || applyToChildren) ? { color: 'green' } : null}>{t('to apply with children')} {(object.folder || childrenCount > 1) ? `(${childrenCount} ${t('object(s)')})` : ''}</div>\n                </div>\n\n                {progress && <LinearProgress/>}\n\n                <div style={{ overflowY: 'auto' }}>\n                    <div>\n                        <h2>{t('File rights')}</h2>\n                        <ObjectRights\n                            disabled={progress}\n                            mask={maskObject}\n                            setMask={setMaskObject}\n                            applyToChildren={applyToChildren}\n                            differentValues={differentObject}\n                            t={t}\n                            setValue={e => {\n                                setValueFileAccessControl(e);\n                                setDisabledButton(false);\n                            }}\n                            value={valueFileAccessControl} />\n                    </div>\n                </div>\n            </div>\n        </CustomModal>;\n    }\n}\n\nexport default FileEditOfAccessControl2;","import { Component } from 'react';\n\nimport PropTypes from 'prop-types';\nimport LinearProgress from '@material-ui/core/LinearProgress';\n\nimport FileBrowser from '../components/FileBrowser';\n\nimport TabContainer from '../components/TabContainer';\nimport TabContent from '../components/TabContent';\nimport FileEditOfAccessControl from '../dialogs/FileEditOfAccessControl';\n\nclass Files extends Component {\n    constructor(props) {\n        super(props);\n        this.t = this.translate;\n        this.wordCache = {};\n        this.objects = {};\n    }\n\n    componentDidMount() {\n        this.props.socket.getObjects(true, true)\n            .then(objects =>\n                this.objects = objects)\n    }\n\n    translate = (word, arg1, arg2) => {\n        if (arg1 !== undefined) {\n            return this.props.t(word, arg1, arg2);\n        }\n\n        if (!this.wordCache[word]) {\n            this.wordCache[word] = this.props.t(word);\n        }\n\n        return this.wordCache[word];\n    }\n\n    render() {\n        if (!this.props.ready) {\n            return <LinearProgress />;\n        }\n\n        return <TabContainer>\n            <TabContent overflow=\"auto\">\n                <FileBrowser\n                    showViewTypeButton={true}\n                    ready={this.props.ready}\n                    socket={this.props.socket}\n                    themeName={this.props.themeName}\n                    lang={this.props.lang}\n                    t={this.props.t}\n                    showToolbar={true}\n                    allowUpload={true}\n                    allowView={true}\n                    allowDownload={true}\n                    allowCreateFolder={true}\n                    allowDelete={true}\n                    expertMode={this.props.expertMode}\n                    modalEditOfAccessControl={(context, objData) =>\n                        <FileEditOfAccessControl\n                            open={context.state.modalEditOfAccess}\n                            themeType={this.props.themeType}\n                            extendObject={async (adapter, file, data) => {\n                                let promise;\n                                if (file && typeof file === 'object') {\n                                    const obj = file;\n                                    // it is setObject\n                                    promise = this.props.socket.getObject(obj._id)\n                                        .then(oldObj => {\n                                            oldObj.acl = obj.acl;\n                                            return this.props.socket.setObject(oldObj._id, oldObj)\n                                                .then(() => oldObj);\n                                        });\n                                } else if (file) {\n                                    if ((data.owner || data.ownerGroup) && data.permissions) {\n                                        promise = this.props.socket.chownFile(adapter, file, {owner: data.owner, ownerGroup: data.ownerGroup})\n                                            .then(() => this.props.socket.chmodFile(adapter, file, {mode: data.permissions}));\n                                    } else\n                                    if (data.permissions) {\n                                        promise = this.props.socket.chmodFile(adapter, file, {mode: data.permissions});\n                                    } else if (data.owner || data.ownerGroup) {\n                                        promise = this.props.socket.chownFile(adapter, file, {owner: data.owner, ownerGroup: data.ownerGroup});\n                                    }\n                                }\n\n                                if (promise) {\n                                    const result = await promise;\n                                    if (result.entries) {\n                                        if (result?.entries) {\n                                            for ( let i = 0; i < result?.entries.length; i++) {\n                                                await context.updateItemsAcl([{id: adapter + '/' + (result.entries[i].path ? result.entries[i].path + '/' : '') + result.entries[i].file, acl: result.entries[i].acl}]);\n                                            }\n                                        }\n                                    } else if (result) {\n                                        await context.updateItemsAcl([{id: result._id, acl: result.acl}]);\n                                    }\n                                }\n                            }}\n                            selected={context.state.selected}\n                            folders={context.state.folders}\n                            objects={this.objects}\n                            socket={this.props.socket}\n                            t={this.t}\n                            onClose={() => context.setState({ modalEditOfAccess: false, modalEditOfAccessObjData: null })}\n                            onApply={() => context.setState({ modalEditOfAccess: false, modalEditOfAccessObjData: null })} />\n                    }\n                />\n            </TabContent>\n        </TabContainer>;\n    }\n}\n\nFiles.propTypes = {\n    t: PropTypes.func,\n    lang: PropTypes.string,\n    socket: PropTypes.object,\n    ready: PropTypes.bool,\n    expertMode: PropTypes.bool,\n    themeType: PropTypes.string,\n};\n\nexport default Files;"],"sourceRoot":""}